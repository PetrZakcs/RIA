{% extends "index.html" %}

{% block results %}
{% if results %}
<p>Nalezeno {{ results|length }} nemovitost칤. Analyzov치no na z치klad캩 nativn칤ho API hled치n칤.</p>
<div class="cards-grid">
    {% for item in results %}
    <div class="card property-card" onclick="window.open('{{ item.ad.source_url }}', '_blank')"
        style="cursor: pointer;">

        <!-- Image -->
        <div class="card-image">
            <img src="{{ item.ad.images[0] if item.ad.images else 'https://via.placeholder.com/300x200?text=No+Image' }}"
                loading="lazy" alt="Property">
        </div>

        <!-- Content -->
        <div class="card-content">
            <h3><a href="{{ item.ad.source_url }}" target="_blank">{{ item.ad.title }}</a></h3>
            <p class="location">游늸 {{ item.ad.locality }}</p>

            <!-- Rating Moved Here -->
            <p
                style="font-size: 0.9rem; margin-top: -0.5rem; margin-bottom: 0.5rem; color: {{ 'var(--success-color)' if item.metrics.is_good_deal else '#777' }}">
                <strong>Hodnocen칤:</strong> {{ 'V칳born치 (A)' if item.metrics.is_good_deal else 'Ostatn칤 (B)' }}
            </p>


            <div class="stats-row">
                <div>
                    <span class="label">Cena</span>
                    <span class="value">{{ "{:,}".format(item.ad.price_czk).replace(',', ' ') }} K캜</span>
                </div>
                <div>
                    <span class="label">Odh. n치jem</span>
                    <span class="value">{{ "{:,}".format(item.metrics.estimated_annual_rent_czk // 12).replace(',', ' ')
                        }} /m캩s</span>
                </div>
            </div>

            <div class="stats-row highlight">
                <div>
                    <span class="label">N치jem/m</span>
                    <span class="value">{{ item.metrics.monthly_rent_per_m2 }} K캜/m</span>
                </div>
                <div>
                    <span class="label">Tr쬹칤 Pr콢m캩r</span>
                    <span class="value">{{ "{:,}".format(item.metrics.market_sale_per_m2).replace(',', ' ') }}</span>
                </div>
            </div>

            <div style="margin-top:0.5rem; text-align:right;">
                <span class="label">vs Trh: </span>
                <span
                    style="font-weight:bold; color: {{ 'var(--success-color)' if item.metrics.undervaluation_percent > 0 else 'var(--danger-color)' }}">
                    {{ "{:+.1f}".format(item.metrics.undervaluation_percent) }}%
                </span>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="no-results">
    <p>콯치dn칠 v칳sledky. Zkuste jin칳 dotaz (nap콏. "Byt v Praze do 5M").</p>
</div>
{% endif %}

{% endblock %}